!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){!function(e){var t=function(e){var t=Math.abs(e),n=1/(1+t/2),r=n*Math.exp(-t*t-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(n*(.27886807+n*(n*(1.48851587+n*(.17087277*n-.82215223))-1.13520398))-.18628806)))));return e>=0?r:2-r},n=function(e,t){if(t<=0)throw new Error("Variance must be > 0 (but was "+t+")");this.mean=e,this.variance=t,this.standardDeviation=Math.sqrt(t)};n.prototype.pdf=function(e){var t=this.standardDeviation*Math.sqrt(2*Math.PI);return Math.exp(-Math.pow(e-this.mean,2)/(2*this.variance))/t},n.prototype.cdf=function(e){return.5*t(-(e-this.mean)/(this.standardDeviation*Math.sqrt(2)))},n.prototype.ppf=function(e){return this.mean-this.standardDeviation*Math.sqrt(2)*function(e){if(e>=2)return-100;if(e<=0)return 100;for(var n=e<1?e:2-e,r=Math.sqrt(-2*Math.log(n/2)),a=-.70711*((2.30753+.27061*r)/(1+r*(.99229+.04481*r))-r),i=0;i<2;i++){var o=t(a)-n;a+=o/(1.1283791670955126*Math.exp(-a*a)-a*o)}return e<1?a:-a}(2*e)},n.prototype.mul=function(e){if("number"==typeof e)return this.scale(e);var t=1/this.variance,n=1/e.variance;return a(t+n,t*this.mean+n*e.mean)},n.prototype.div=function(e){if("number"==typeof e)return this.scale(1/e);var t=1/this.variance,n=1/e.variance;return a(t-n,t*this.mean-n*e.mean)},n.prototype.add=function(e){return r(this.mean+e.mean,this.variance+e.variance)},n.prototype.sub=function(e){return r(this.mean-e.mean,this.variance+e.variance)},n.prototype.scale=function(e){return r(this.mean*e,this.variance*e*e)};var r=function(e,t){return new n(e,t)},a=function(e,t){return r(t/e,1/e)};e(r)}((function(t){e.exports=t}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.postMessage=t}var t,n,a;return t=e,(n=[{key:"clear",value:function(){this.postMessage({cmd:"render:clear"})}},{key:"line",value:function(e,t){this.postMessage({cmd:"render:line",from:e,to:t})}},{key:"node",value:function(e){this.postMessage({cmd:"render:node",center:e})}},{key:"root",value:function(e){this.postMessage({cmd:"render:root",center:e})}},{key:"done",value:function(){this.postMessage({cmd:"render:done"})}},{key:"minSeekRadius",set:function(e){this.postMessage({cmd:"render:setMinSeekRadius",radius:e})}},{key:"maxSeekRadius",set:function(e){this.postMessage({cmd:"render:setMaxSeekRadius",radius:e})}}])&&r(t.prototype,n),a&&r(t,a),e}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i(this,e),this.width=t,this.height=n,this.maxRadius=a||.45*Math.min(t,n),this.minRadius=r||this.maxRadius/2,this.center={x:t/2,y:n/2}}var t,n,r;return t=e,(n=[{key:"canPlaceRoot",value:function(e,t){var n=s(this.center,{x:e,y:t}),r=(this.maxRadius-this.minRadius)/4,a=this.minRadius+r,i=this.maxRadius-r;return a<n&&n<i}},{key:"canPlaceNode",value:function(e,t){var n=s(this.center,{x:e,y:t});return this.minRadius<n&&n<this.maxRadius}}])&&o(t.prototype,n),r&&o(t,r),e}();function s(e,t){return n=c(e.x-t.x)+c(e.y-t.y),Math.sqrt(n);var n}function c(e){return e*e}var h=n(0),f=n.n(h)()(0,1),d=function(e,t){return Math.round(function(e,t){if(void 0===t&&(t=e,e=0),"number"!=typeof e||"number"!=typeof t)throw new TypeError("Expected all arguments to be numbers");return Math.random()*(t-e)+e}(e,t))};function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.height=n,this.width=t,this.zoneSize=r,this.widthZones=Math.ceil(t/r)+2,this.heightZones=Math.ceil(n/r)+2,this._zonemap=Array.from(new Array(this.numZones),(function(){return[]}))}var t,n,r;return t=e,(n=[{key:"zoneIndex",value:function(e,t){var n=Math.floor(e/this.zoneSize)+1;return(Math.floor(t/this.zoneSize)+1)*this.widthZones+n}},{key:"addItem",value:function(e,t,n){var r=this.zoneIndex(e,t);this._zonemap[r].push(n)}},{key:"getItemsInZone",value:function(e){this._zonemap[e]}},{key:"getAdjacentZoneIndexes",value:function(e,t){var n=this,r=this.zoneIndex(e,t),a=[r-1,r,r+1].map((function(e){return e-n.widthZones})),i=[r-1,r,r+1],o=[r-1,r,r+1].map((function(e){return e+n.widthZones}));return a.concat(i).concat(o)}},{key:"getItemsInAdjacentZones",value:function(e,t){var n=this;return this.getAdjacentZoneIndexes(e,t).map((function(e){return n._zonemap[e]})).flat()}},{key:"numZones",get:function(){return this.widthZones*this.heightZones}},{key:"zoneCoordinates",get:function(){var e=this;return Array.from(new Array(this.numZones),(function(t,n){var r=n%e.widthZones-1,a=Math.floor(n/e.widthZones)-1;return[r*e.zoneSize,a*e.zoneSize]}))}}])&&l(t.prototype,n),r&&l(t,r),e}();function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t,n){var r,a=e.width,i=e.height,o=e.maxSeekRadius,u=e.minSeekRadius,s=e.seekRadiusDecay,c=e.numRoots,h=e.maxBranchAttempts,l=e.angleMax,v=e.branchSpacing,y=[],w=new m(a,i,1.5*o);n.minSeekRadius=u,n.maxSeekRadius=o,function(e,t,n,r,a){return Array.from(new Array(e)).map((function(){var e,r;do{e=d(t),r=d(n)}while(!a.canPlaceRoot(e,r));return[e,r]})).map((function(e,t){var n=p(e,2),a=M(n[0],n[1]);return a.r=r,a.theta=d(360),a.treeId=t,a}))}(c,i,a,o,t).forEach((function(e){y.push(e),w.addItem(e.x,e.y,e),n.root(e)}));for(var x=0;x<1e6;x++){var k=(r=y)[d(r.length-1)];if(k.alive)if(k.branchAttempts++,h<k.branchAttempts)k.alive=!1;else if(k.r<u)k.alive=!1;else{var S=M();S.parent=k,S.treeId=k.treeId,S.r=k.r+0,S.theta=k.theta,S.branchDepth=k.branchDepth,0<k.children.length&&(S.branchDepth++,S.r*=s),S.theta+=(1-1/Math.pow(S.branchDepth+1,.1))*f.ppf(Math.random())*l;var I=p(b(S.theta,k.r),2),R=I[0],A=I[1];S.x=k.x+R,S.y=k.y+A,g(S,t,w,v)&&(y.push(S),w.addItem(S.x,S.y,S),k.children.push(S),n.line(k,S))}}n.done()}function b(e,t){var n=e*Math.PI/180;return[Math.cos(n)*t,Math.sin(n)*t]}function g(e,t,n,r){return!!t.canPlaceNode(e.x,e.y)&&n.getItemsInAdjacentZones(e.x,e.y).map((function(t){var n=Math.sqrt(w(e.x-t.x)+w(e.y-t.y));return t.r+e.r<n*r})).every((function(e){return e}))}function w(e){return e*e}function M(e,t){return{x:e,y:t,r:1,theta:0,branchDepth:1,branchAttempts:0,parent:null,children:[],treeId:0,alive:!0}}onmessage=function(e){switch(console.log("[grow.worker] received message ".concat(e.data.cmd)),e.data.cmd){case"run":t=e.data.params,n=t.width,r=t.height,i=new a((function(e){return postMessage(e)})),o=new u(n,r,100,280),y(t,o,i);break;default:console.log("[grow.worker] unknown command ".concat(e.data.cmd,", data: ").concat(e.data))}var t,n,r,i,o}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2dhdXNzaWFuL2xpYi9nYXVzc2lhbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVuZGVyL3JlbmRlcl9lbWl0dGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9tYXNrL21hc2tfZG9udXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL3JhbmRvbS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMvem9uZW1hcC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZ3Jvd2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9ncm93Lndvcmtlci5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImVyZmMiLCJ4IiwieiIsIk1hdGgiLCJhYnMiLCJleHAiLCJHYXVzc2lhbiIsIm1lYW4iLCJ2YXJpYW5jZSIsIkVycm9yIiwidGhpcyIsInN0YW5kYXJkRGV2aWF0aW9uIiwic3FydCIsInBkZiIsIlBJIiwicG93IiwiY2RmIiwicHBmIiwieHgiLCJsb2ciLCJqIiwiZXJyIiwiaWVyZmMiLCJtdWwiLCJzY2FsZSIsInByZWNpc2lvbiIsImRwcmVjaXNpb24iLCJmcm9tUHJlY2lzaW9uTWVhbiIsImRpdiIsImFkZCIsImdhdXNzaWFuIiwic3ViIiwicHJlY2lzaW9ubWVhbiIsImUiLCJSZW5kZXJFbWl0dGVyIiwicG9zdE1lc3NhZ2UiLCJjbWQiLCJmcm9tIiwidG8iLCJjZW50ZXIiLCJyYWRpdXMiLCJNYXNrRG9udXQiLCJ3IiwiaCIsIm1pblJhZGl1cyIsIm1heFJhZGl1cyIsIndpZHRoIiwiaGVpZ2h0IiwibWluIiwieSIsImRpc3QiLCJyb290QmFuZCIsInJvb3RNaW5SYWRpdXMiLCJyb290TWF4UmFkaXVzIiwic3EiLCJub3JtYWxfZGlzdHJpYnV0aW9uIiwicmFuZG9tSW50IiwibWF4Iiwicm91bmQiLCJ1bmRlZmluZWQiLCJUeXBlRXJyb3IiLCJyYW5kb20iLCJyYW5kb21GbG9hdCIsIlpvbmVNYXAiLCJ6b25lU2l6ZSIsIndpZHRoWm9uZXMiLCJjZWlsIiwiaGVpZ2h0Wm9uZXMiLCJfem9uZW1hcCIsIkFycmF5IiwibnVtWm9uZXMiLCJ6b25lWCIsImZsb29yIiwiaXRlbSIsImluZGV4Iiwiem9uZUluZGV4IiwicHVzaCIsInJvd0Fib3ZlIiwibWFwIiwidiIsInRoaXNSb3ciLCJyb3dCZWxvdyIsImNvbmNhdCIsImdldEFkamFjZW50Wm9uZUluZGV4ZXMiLCJmbGF0IiwiXyIsInpvbmVZIiwiZ3JvdyIsInBhcmFtcyIsIm1hc2siLCJyZW5kZXJlciIsImxpc3QiLCJtYXhTZWVrUmFkaXVzIiwibWluU2Vla1JhZGl1cyIsInNlZWtSYWRpdXNEZWNheSIsIm51bVJvb3RzIiwibWF4QnJhbmNoQXR0ZW1wdHMiLCJhbmdsZU1heCIsImJyYW5jaFNwYWNpbmciLCJhbGxOb2RlcyIsInpvbmVNYXAiLCJjYW5QbGFjZVJvb3QiLCJyb290IiwibmV3Tm9kZSIsInRoZXRhIiwidHJlZUlkIiwiYnVpbGRSb290cyIsImZvckVhY2giLCJhZGRJdGVtIiwicGFyZW50Tm9kZSIsImxlbmd0aCIsImFsaXZlIiwiYnJhbmNoQXR0ZW1wdHMiLCJub2RlIiwicGFyZW50IiwiYnJhbmNoRGVwdGgiLCJjaGlsZHJlbiIsInZlY3RvciIsInZ4IiwidnkiLCJjYW5QbGFjZU5vZGUiLCJsaW5lIiwiZG9uZSIsImFuZ2xlRGVnIiwicmFkaWFucyIsImNvcyIsInNpbiIsImdldEl0ZW1zSW5BZGphY2VudFpvbmVzIiwiZGlzdGFuY2VCZXR3ZWVuTm9kZXMiLCJzcXVhcmUiLCJldmVyeSIsIm9ubWVzc2FnZSIsImNvbnNvbGUiLCJkYXRhIiwicmVuZGVyIiwibXNnIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8s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LEdBQ2xCLE1BQU8sQ0FDTGhELElBQ0FnRCxJQUNBbkUsRUFBRyxFQUNIMEgsTUFBTyxFQUNQVyxZQUFhLEVBQ2JILGVBQWdCLEVBQ2hCRSxPQUFRLEtBQ1JFLFNBQVUsR0FDVlgsT0FBUSxFQUNSTSxPQUFPLEdDM0pYb0IsVUFBWSxTQUFDbEcsR0FFWCxPQURBbUcsUUFBUWpILElBQVIseUNBQThDYyxFQUFFb0csS0FBS2pHLE1BQzdDSCxFQUFFb0csS0FBS2pHLEtBQ2IsSUFBSyxNQVFJb0QsRUFQSHZELEVBQUVvRyxLQUFLN0MsT0FRUDFDLEVBQWtCMEMsRUFBbEIxQyxNQUFPQyxFQUFXeUMsRUFBWHpDLE9BRVh1RixFQUFTLElBQUlwRyxHQUFjLFNBQUNxRyxHQUFELE9BQVNwRyxZQUFZb0csTUFDaEQ5QyxFQUFPLElBQUloRCxFQUFVSyxFQUFPQyxFQUFRLElBQUssS0FFN0N3QyxFQUFLQyxFQUFRQyxFQUFNNkMsR0FaZixNQUNGLFFBQ0VGLFFBQVFqSCxJQUFSLHdDQUE2Q2MsRUFBRW9HLEtBQUtqRyxJQUFwRCxtQkFBa0VILEVBQUVvRyxPQUkxRSxJQUFhN0MsRUFDSDFDLEVBQU9DLEVBRVh1RixFQUNBN0MiLCJmaWxlIjoiM2ZlNGQ0N2RhN2M5ZWE2NWEwZjAud29ya2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiKGZ1bmN0aW9uKGV4cG9ydHMpIHtcblxuICAvLyBDb21wbGVtZW50YXJ5IGVycm9yIGZ1bmN0aW9uXG4gIC8vIEZyb20gTnVtZXJpY2FsIFJlY2lwZXMgaW4gQyAyZSBwMjIxXG4gIHZhciBlcmZjID0gZnVuY3Rpb24oeCkge1xuICAgIHZhciB6ID0gTWF0aC5hYnMoeCk7XG4gICAgdmFyIHQgPSAxIC8gKDEgKyB6IC8gMik7XG4gICAgdmFyIHIgPSB0ICogTWF0aC5leHAoLXogKiB6IC0gMS4yNjU1MTIyMyArIHQgKiAoMS4wMDAwMjM2OCArXG4gICAgICAgICAgICB0ICogKDAuMzc0MDkxOTYgKyB0ICogKDAuMDk2Nzg0MTggKyB0ICogKC0wLjE4NjI4ODA2ICtcbiAgICAgICAgICAgIHQgKiAoMC4yNzg4NjgwNyArIHQgKiAoLTEuMTM1MjAzOTggKyB0ICogKDEuNDg4NTE1ODcgK1xuICAgICAgICAgICAgdCAqICgtMC44MjIxNTIyMyArIHQgKiAwLjE3MDg3Mjc3KSkpKSkpKSkpXG4gICAgcmV0dXJuIHggPj0gMCA/IHIgOiAyIC0gcjtcbiAgfTtcblxuICAvLyBJbnZlcnNlIGNvbXBsZW1lbnRhcnkgZXJyb3IgZnVuY3Rpb25cbiAgLy8gRnJvbSBOdW1lcmljYWwgUmVjaXBlcyAzZSBwMjY1XG4gIHZhciBpZXJmYyA9IGZ1bmN0aW9uKHgpIHtcbiAgICBpZiAoeCA+PSAyKSB7IHJldHVybiAtMTAwOyB9XG4gICAgaWYgKHggPD0gMCkgeyByZXR1cm4gMTAwOyB9XG5cbiAgICB2YXIgeHggPSAoeCA8IDEpID8geCA6IDIgLSB4O1xuICAgIHZhciB0ID0gTWF0aC5zcXJ0KC0yICogTWF0aC5sb2coeHggLyAyKSk7XG5cbiAgICB2YXIgciA9IC0wLjcwNzExICogKCgyLjMwNzUzICsgdCAqIDAuMjcwNjEpIC9cbiAgICAgICAgICAgICgxICsgdCAqICgwLjk5MjI5ICsgdCAqIDAuMDQ0ODEpKSAtIHQpO1xuXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCAyOyBqKyspIHtcbiAgICAgIHZhciBlcnIgPSBlcmZjKHIpIC0geHg7XG4gICAgICByICs9IGVyciAvICgxLjEyODM3OTE2NzA5NTUxMjU3ICogTWF0aC5leHAoLShyICogcikpIC0gciAqIGVycik7XG4gICAgfVxuXG4gICAgcmV0dXJuICh4IDwgMSkgPyByIDogLXI7XG4gIH07XG5cbiAgLy8gTW9kZWxzIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uXG4gIHZhciBHYXVzc2lhbiA9IGZ1bmN0aW9uKG1lYW4sIHZhcmlhbmNlKSB7XG4gICAgaWYgKHZhcmlhbmNlIDw9IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVmFyaWFuY2UgbXVzdCBiZSA+IDAgKGJ1dCB3YXMgJyArIHZhcmlhbmNlICsgJyknKTtcbiAgICB9XG4gICAgdGhpcy5tZWFuID0gbWVhbjtcbiAgICB0aGlzLnZhcmlhbmNlID0gdmFyaWFuY2U7XG4gICAgdGhpcy5zdGFuZGFyZERldmlhdGlvbiA9IE1hdGguc3FydCh2YXJpYW5jZSk7XG4gIH1cblxuICAvLyBQcm9iYWJpbGl0eSBkZW5zaXR5IGZ1bmN0aW9uXG4gIEdhdXNzaWFuLnByb3RvdHlwZS5wZGYgPSBmdW5jdGlvbih4KSB7XG4gICAgdmFyIG0gPSB0aGlzLnN0YW5kYXJkRGV2aWF0aW9uICogTWF0aC5zcXJ0KDIgKiBNYXRoLlBJKTtcbiAgICB2YXIgZSA9IE1hdGguZXhwKC1NYXRoLnBvdyh4IC0gdGhpcy5tZWFuLCAyKSAvICgyICogdGhpcy52YXJpYW5jZSkpO1xuICAgIHJldHVybiBlIC8gbTtcbiAgfTtcblxuICAvLyBDdW11bGF0aXZlIGRlbnNpdHkgZnVuY3Rpb25cbiAgR2F1c3NpYW4ucHJvdG90eXBlLmNkZiA9IGZ1bmN0aW9uKHgpIHtcbiAgICByZXR1cm4gMC41ICogZXJmYygtKHggLSB0aGlzLm1lYW4pIC8gKHRoaXMuc3RhbmRhcmREZXZpYXRpb24gKiBNYXRoLnNxcnQoMikpKTtcbiAgfTtcblxuICAvLyBQZXJjZW50IHBvaW50IGZ1bmN0aW9uXG4gIEdhdXNzaWFuLnByb3RvdHlwZS5wcGYgPSBmdW5jdGlvbih4KSB7XG4gICAgcmV0dXJuIHRoaXMubWVhbiAtIHRoaXMuc3RhbmRhcmREZXZpYXRpb24gKiBNYXRoLnNxcnQoMikgKiBpZXJmYygyICogeCk7XG4gIH07XG5cbiAgLy8gUHJvZHVjdCBkaXN0cmlidXRpb24gb2YgdGhpcyBhbmQgZCAoc2NhbGUgZm9yIGNvbnN0YW50KVxuICBHYXVzc2lhbi5wcm90b3R5cGUubXVsID0gZnVuY3Rpb24oZCkge1xuICAgIGlmICh0eXBlb2YoZCkgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHJldHVybiB0aGlzLnNjYWxlKGQpO1xuICAgIH1cbiAgICB2YXIgcHJlY2lzaW9uID0gMSAvIHRoaXMudmFyaWFuY2U7XG4gICAgdmFyIGRwcmVjaXNpb24gPSAxIC8gZC52YXJpYW5jZTtcbiAgICByZXR1cm4gZnJvbVByZWNpc2lvbk1lYW4oXG4gICAgICAgIHByZWNpc2lvbiArIGRwcmVjaXNpb24sIFxuICAgICAgICBwcmVjaXNpb24gKiB0aGlzLm1lYW4gKyBkcHJlY2lzaW9uICogZC5tZWFuKTtcbiAgfTtcblxuICAvLyBRdW90aWVudCBkaXN0cmlidXRpb24gb2YgdGhpcyBhbmQgZCAoc2NhbGUgZm9yIGNvbnN0YW50KVxuICBHYXVzc2lhbi5wcm90b3R5cGUuZGl2ID0gZnVuY3Rpb24oZCkge1xuICAgIGlmICh0eXBlb2YoZCkgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHJldHVybiB0aGlzLnNjYWxlKDEgLyBkKTtcbiAgICB9XG4gICAgdmFyIHByZWNpc2lvbiA9IDEgLyB0aGlzLnZhcmlhbmNlO1xuICAgIHZhciBkcHJlY2lzaW9uID0gMSAvIGQudmFyaWFuY2U7XG4gICAgcmV0dXJuIGZyb21QcmVjaXNpb25NZWFuKFxuICAgICAgICBwcmVjaXNpb24gLSBkcHJlY2lzaW9uLCBcbiAgICAgICAgcHJlY2lzaW9uICogdGhpcy5tZWFuIC0gZHByZWNpc2lvbiAqIGQubWVhbik7XG4gIH07XG5cbiAgLy8gQWRkaXRpb24gb2YgdGhpcyBhbmQgZFxuICBHYXVzc2lhbi5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24oZCkge1xuICAgIHJldHVybiBnYXVzc2lhbih0aGlzLm1lYW4gKyBkLm1lYW4sIHRoaXMudmFyaWFuY2UgKyBkLnZhcmlhbmNlKTtcbiAgfTtcblxuICAvLyBTdWJ0cmFjdGlvbiBvZiB0aGlzIGFuZCBkXG4gIEdhdXNzaWFuLnByb3RvdHlwZS5zdWIgPSBmdW5jdGlvbihkKSB7XG4gICAgcmV0dXJuIGdhdXNzaWFuKHRoaXMubWVhbiAtIGQubWVhbiwgdGhpcy52YXJpYW5jZSArIGQudmFyaWFuY2UpO1xuICB9O1xuXG4gIC8vIFNjYWxlIHRoaXMgYnkgY29uc3RhbnQgY1xuICBHYXVzc2lhbi5wcm90b3R5cGUuc2NhbGUgPSBmdW5jdGlvbihjKSB7XG4gICAgcmV0dXJuIGdhdXNzaWFuKHRoaXMubWVhbiAqIGMsIHRoaXMudmFyaWFuY2UgKiBjICogYyk7XG4gIH07XG5cbiAgdmFyIGdhdXNzaWFuID0gZnVuY3Rpb24obWVhbiwgdmFyaWFuY2UpIHtcbiAgICByZXR1cm4gbmV3IEdhdXNzaWFuKG1lYW4sIHZhcmlhbmNlKTtcbiAgfTtcblxuICB2YXIgZnJvbVByZWNpc2lvbk1lYW4gPSBmdW5jdGlvbihwcmVjaXNpb24sIHByZWNpc2lvbm1lYW4pIHtcbiAgICByZXR1cm4gZ2F1c3NpYW4ocHJlY2lzaW9ubWVhbiAvIHByZWNpc2lvbiwgMSAvIHByZWNpc2lvbik7XG4gIH07XG5cbiAgZXhwb3J0cyhnYXVzc2lhbik7XG59KVxuKHR5cGVvZihleHBvcnRzKSAhPT0gXCJ1bmRlZmluZWRcIlxuICAgID8gZnVuY3Rpb24oZSkgeyBtb2R1bGUuZXhwb3J0cyA9IGU7IH1cbiAgICA6IGZ1bmN0aW9uKGUpIHsgdGhpc1tcImdhdXNzaWFuXCJdID0gZTsgfSk7XG4iLCJjbGFzcyBSZW5kZXJFbWl0dGVyIHtcbiAgY29uc3RydWN0b3IocG9zdE1lc3NhZ2UpIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlID0gcG9zdE1lc3NhZ2VcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMucG9zdE1lc3NhZ2Uoe1xuICAgICAgY21kOiAncmVuZGVyOmNsZWFyJyxcbiAgICB9KVxuICB9XG5cbiAgbGluZShmcm9tLCB0bykge1xuICAgIHRoaXMucG9zdE1lc3NhZ2Uoe1xuICAgICAgY21kOiAncmVuZGVyOmxpbmUnLFxuICAgICAgZnJvbSxcbiAgICAgIHRvXG4gICAgfSlcbiAgfVxuXG4gIG5vZGUoY2VudGVyKSB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZSh7XG4gICAgICBjbWQ6ICdyZW5kZXI6bm9kZScsXG4gICAgICBjZW50ZXJcbiAgICB9KVxuICB9XG5cbiAgcm9vdChjZW50ZXIpIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKHtcbiAgICAgIGNtZDogJ3JlbmRlcjpyb290JyxcbiAgICAgIGNlbnRlclxuICAgIH0pXG4gIH1cblxuICBkb25lKCkge1xuICAgIHRoaXMucG9zdE1lc3NhZ2Uoe1xuICAgICAgY21kOiAncmVuZGVyOmRvbmUnXG4gICAgfSlcbiAgfVxuXG4gIHNldCBtaW5TZWVrUmFkaXVzKHIpIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKHtcbiAgICAgIGNtZDogJ3JlbmRlcjpzZXRNaW5TZWVrUmFkaXVzJyxcbiAgICAgIHJhZGl1czogclxuICAgIH0pXG4gIH1cblxuICBzZXQgbWF4U2Vla1JhZGl1cyhyKSB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZSh7XG4gICAgICBjbWQ6ICdyZW5kZXI6c2V0TWF4U2Vla1JhZGl1cycsXG4gICAgICByYWRpdXM6IHJcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCB7IFJlbmRlckVtaXR0ZXIgfVxuIiwiY2xhc3MgTWFza0RvbnV0IHtcbiAgY29uc3RydWN0b3IodywgaCwgbWluUmFkaXVzID0gbnVsbCwgbWF4UmFkaXVzID0gbnVsbCkge1xuICAgIHRoaXMud2lkdGggPSB3XG4gICAgdGhpcy5oZWlnaHQgPSBoXG4gICAgdGhpcy5tYXhSYWRpdXMgPSBtYXhSYWRpdXMgfHwgTWF0aC5taW4odywgaCkgKiAuNDVcbiAgICB0aGlzLm1pblJhZGl1cyA9IG1pblJhZGl1cyB8fCB0aGlzLm1heFJhZGl1cyAvIDJcbiAgICB0aGlzLmNlbnRlciA9IHt4OiB3LzIsIHk6IGgvMiB9XG4gIH1cblxuICBjYW5QbGFjZVJvb3QoeCwgeSkge1xuICAgIGxldCBkID0gZGlzdCh0aGlzLmNlbnRlciwge3gsIHl9KVxuXG4gICAgbGV0IHJhZGl1c0Rpc3RhbmNlID0gdGhpcy5tYXhSYWRpdXMgLSB0aGlzLm1pblJhZGl1cyxcbiAgICAgICAgcm9vdEJhbmQgPSByYWRpdXNEaXN0YW5jZSAvIDQsXG4gICAgICAgIHJvb3RNaW5SYWRpdXMgPSB0aGlzLm1pblJhZGl1cyArIHJvb3RCYW5kLFxuICAgICAgICByb290TWF4UmFkaXVzID0gdGhpcy5tYXhSYWRpdXMgLSByb290QmFuZFxuXG4gICAgcmV0dXJuIChcbiAgICAgIHJvb3RNaW5SYWRpdXMgPCBkICYmIGQgPCByb290TWF4UmFkaXVzXG4gICAgKVxuICB9XG5cbiAgY2FuUGxhY2VOb2RlKHgsIHkpIHtcbiAgICBsZXQgZCA9IGRpc3QodGhpcy5jZW50ZXIsIHt4LCB5fSlcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5taW5SYWRpdXMgPCBkICYmIGQgPCB0aGlzLm1heFJhZGl1c1xuICAgIClcbiAgfVxufVxuXG5mdW5jdGlvbiBkaXN0KGZyb20sIHRvKSB7XG4gIHJldHVybiBzcXJ0KCBzcShmcm9tLnggLSB0by54KSArIHNxKGZyb20ueSAtIHRvLnkpIClcbn1cbmZ1bmN0aW9uIHNxKG4pIHsgcmV0dXJuIG4gKiBuIH1cbmZ1bmN0aW9uIHNxcnQobikgeyByZXR1cm4gTWF0aC5zcXJ0KG4pIH1cblxuZXhwb3J0IHsgTWFza0RvbnV0IH0iLCJpbXBvcnQgZ2F1c3NpYW4gZnJvbSAnZ2F1c3NpYW4nXG5cbmxldCBub3JtYWxfZGlzdHJpYnV0aW9uID0gZ2F1c3NpYW4oMCwgMSkgLy8gbWVhbiAwLCBzdGFuZGFyZCBkZXZpYXRpb24gMVxuXG5leHBvcnQgY29uc3QgcmFuZG9tRmxvYXQgPSAobWluLCBtYXgpID0+IHtcbiAgaWYgKG1heCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbWF4ID0gbWluO1xuICAgIG1pbiA9IDA7XG4gIH1cblxuICBpZiAodHlwZW9mIG1pbiAhPT0gJ251bWJlcicgfHwgdHlwZW9mIG1heCAhPT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCBhbGwgYXJndW1lbnRzIHRvIGJlIG51bWJlcnMnKTtcbiAgfVxuXG4gIHJldHVybiBNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW47XG59O1xuXG5leHBvcnQgY29uc3QgcmFuZG9tSW50ID0gKG1pbiwgbWF4KSA9PiBNYXRoLnJvdW5kKCByYW5kb21GbG9hdChtaW4sIG1heCkgKVxuXG5leHBvcnQgY29uc3QgcmFuZG9tR2F1c3NpYW4gPSAoKT0+IG5vcm1hbF9kaXN0cmlidXRpb24ucHBmKE1hdGgucmFuZG9tKCkpIiwiY2xhc3MgWm9uZU1hcCB7XG4gIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIHpvbmVTaXplKSB7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHRcbiAgICB0aGlzLndpZHRoID0gd2lkdGhcbiAgICB0aGlzLnpvbmVTaXplID0gem9uZVNpemVcblxuICAgIC8vIE5vdGUgdGhhdCB3ZSBjcmVhdGUgb25lIGV4dHJhIHJvdyBhbmQgY29sdW1uIG9uIGV2ZXJ5IHNpZGUgdG8gbWFrZSB0aGVcbiAgICAvLyBhZGphY2VudCBjZWxsIGxvb2t1cCB0aGluZyBlYXNpZXJcbiAgICB0aGlzLndpZHRoWm9uZXMgPSBNYXRoLmNlaWwod2lkdGggLyB6b25lU2l6ZSkgKyAyXG4gICAgdGhpcy5oZWlnaHRab25lcyA9IE1hdGguY2VpbChoZWlnaHQgLyB6b25lU2l6ZSkgKyAyXG5cbiAgICAvLyBJbml0aWFsaXplIHRoZSB6b25lbWFwIHdpdGggYW4gZW1wdHkgYXJyYXkgYXQgYWxsIGNlbGxzXG4gICAgdGhpcy5fem9uZW1hcCA9IEFycmF5LmZyb20obmV3IEFycmF5KHRoaXMubnVtWm9uZXMpLCAoKSA9PiBbXSlcbiAgfVxuXG4gIGdldCBudW1ab25lcygpIHtcbiAgICByZXR1cm4gdGhpcy53aWR0aFpvbmVzICogdGhpcy5oZWlnaHRab25lc1xuICB9XG5cbiAgLy8gVG9wLWxlZnQgcGl4ZWwtc3BhY2UgY29vcmRpbmF0ZXMgb2YgYWxsIGNlbGxzXG4gIGdldCB6b25lQ29vcmRpbmF0ZXMoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20obmV3IEFycmF5KHRoaXMubnVtWm9uZXMpLCAoXywgaSkgPT4ge1xuICAgICAgbGV0IHpvbmVYID0gaSAlIHRoaXMud2lkdGhab25lcyAtIDEsXG4gICAgICAgICAgem9uZVkgPSBNYXRoLmZsb29yKGkgLyB0aGlzLndpZHRoWm9uZXMpIC0gMVxuXG4gICAgICByZXR1cm4gW3pvbmVYICogdGhpcy56b25lU2l6ZSwgem9uZVkgKiB0aGlzLnpvbmVTaXplXVxuICAgIH0pXG4gIH1cblxuICB6b25lSW5kZXgoeCwgeSkge1xuICAgIGxldCB6b25lWCA9IE1hdGguZmxvb3IoeCAvIHRoaXMuem9uZVNpemUpICsgMSxcbiAgICAgICAgem9uZVkgPSBNYXRoLmZsb29yKHkgLyB0aGlzLnpvbmVTaXplKSArIDFcblxuICAgIHJldHVybiB6b25lWSAqIHRoaXMud2lkdGhab25lcyArIHpvbmVYXG4gIH1cblxuICBhZGRJdGVtKHgsIHksIGl0ZW0pIHtcbiAgICBsZXQgaW5kZXggPSB0aGlzLnpvbmVJbmRleCh4LCB5KVxuICAgIHRoaXMuX3pvbmVtYXBbaW5kZXhdLnB1c2goaXRlbSlcbiAgfVxuXG4gIGdldEl0ZW1zSW5ab25lKGluZGV4KSB7XG4gICAgdGhpcy5fem9uZW1hcFtpbmRleF1cbiAgfVxuXG4gIC8vIFJldHVybnMgYW4gYXJyYXkgb2YgaW5kZXhlcyBvZiB0aGUgem9uZSB0aGF0IHRoZSAoeCx5KSBjb29yZGluYXRlIGZhbGxzXG4gIC8vIHdpdGhpbiwgYWxvbmcgd2l0aCBhbGwgYWRqYWNlbnQgem9uZXNcbiAgZ2V0QWRqYWNlbnRab25lSW5kZXhlcyh4LCB5KSB7XG4gICAgbGV0IGkgPSB0aGlzLnpvbmVJbmRleCh4LCB5KVxuXG4gICAgbGV0IHJvd0Fib3ZlICA9IFtpLTEsIGksIGkrMV0ubWFwKHYgPT4gdiAtIHRoaXMud2lkdGhab25lcylcbiAgICBsZXQgdGhpc1JvdyAgID0gW2ktMSwgaSwgaSsxXVxuICAgIGxldCByb3dCZWxvdyAgPSBbaS0xLCBpLCBpKzFdLm1hcCh2ID0+IHYgKyB0aGlzLndpZHRoWm9uZXMpXG5cbiAgICByZXR1cm4gcm93QWJvdmUuY29uY2F0KHRoaXNSb3cpLmNvbmNhdChyb3dCZWxvdylcbiAgfVxuXG4gIGdldEl0ZW1zSW5BZGphY2VudFpvbmVzKHgsIHkpIHtcbiAgICByZXR1cm4oXG4gICAgICB0aGlzLmdldEFkamFjZW50Wm9uZUluZGV4ZXMoeCwgeSlcbiAgICAgICAgLm1hcChpID0+IHRoaXMuX3pvbmVtYXBbaV0pXG4gICAgICAgIC5mbGF0KClcbiAgICApXG4gIH1cblxufVxuXG5leHBvcnQgeyBab25lTWFwIH1cbiIsImltcG9ydCB7IHJhbmRvbUludCwgcmFuZG9tRmxvYXQsIHJhbmRvbUdhdXNzaWFuIH0gZnJvbSAnLi91dGlscy9yYW5kb20uanMnXG5pbXBvcnQgeyBab25lTWFwIH0gZnJvbSAnLi91dGlscy96b25lbWFwLmpzJ1xuXG5mdW5jdGlvbiBzbGVlcChtaWxsaXNlY29uZHMpIHtcbiAgY29uc3QgZGF0ZSA9IERhdGUubm93KCk7XG4gIGxldCBjdXJyZW50RGF0ZSA9IG51bGw7XG4gIGRvIHtcbiAgICBjdXJyZW50RGF0ZSA9IERhdGUubm93KCk7XG4gIH0gd2hpbGUgKGN1cnJlbnREYXRlIC0gZGF0ZSA8IG1pbGxpc2Vjb25kcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBncm93KHBhcmFtcywgbWFzaywgcmVuZGVyZXIpIHtcbiAgY29uc3QgaXRlcmF0aW9ucyA9IDEwMDAwMDBcblxuICBjb25zdCB7XG4gICAgd2lkdGgsXG4gICAgaGVpZ2h0LFxuICAgIG1heFNlZWtSYWRpdXMsXG4gICAgbWluU2Vla1JhZGl1cyxcbiAgICBzZWVrUmFkaXVzRGVjYXksXG4gICAgbnVtUm9vdHMsXG4gICAgbWF4QnJhbmNoQXR0ZW1wdHMsXG4gICAgYW5nbGVNYXgsXG4gICAgYnJhbmNoU3BhY2luZyxcbiAgfSA9IHBhcmFtc1xuXG4gIGxldCByb290cyxcbiAgICAgIGFsbE5vZGVzID0gW10sXG4gICAgICB6b25lTWFwID0gbmV3IFpvbmVNYXAod2lkdGgsIGhlaWdodCwgbWF4U2Vla1JhZGl1cyAqIDEuNSlcblxuICByZW5kZXJlci5taW5TZWVrUmFkaXVzID0gbWluU2Vla1JhZGl1c1xuICByZW5kZXJlci5tYXhTZWVrUmFkaXVzID0gbWF4U2Vla1JhZGl1c1xuXG4gIC8vIEluaXRpYWxpemUgcm9vdHNcbiAgcm9vdHMgPSBidWlsZFJvb3RzKG51bVJvb3RzLCBoZWlnaHQsIHdpZHRoLCBtYXhTZWVrUmFkaXVzLCBtYXNrKVxuICByb290cy5mb3JFYWNoKHJvb3QgPT4ge1xuICAgIGFsbE5vZGVzLnB1c2gocm9vdClcbiAgICB6b25lTWFwLmFkZEl0ZW0ocm9vdC54LCByb290LnksIHJvb3QpXG4gICAgcmVuZGVyZXIucm9vdChyb290KVxuICB9KVxuICBcbiAgZm9yKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgIC8vIFBpY2sgYSBub2RlIGF0IHJhbmRvbVxuICAgIGxldCBwYXJlbnROb2RlID0gcmFuZG9tTWVtYmVyKGFsbE5vZGVzKVxuXG4gICAgaWYgKCFwYXJlbnROb2RlLmFsaXZlKVxuICAgICAgY29udGludWVcblxuICAgIHBhcmVudE5vZGUuYnJhbmNoQXR0ZW1wdHMrK1xuICBcbiAgICBpZiAobWF4QnJhbmNoQXR0ZW1wdHMgPCBwYXJlbnROb2RlLmJyYW5jaEF0dGVtcHRzKSB7XG4gICAgICBwYXJlbnROb2RlLmFsaXZlID0gZmFsc2VcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgaWYgKHBhcmVudE5vZGUuciA8IG1pblNlZWtSYWRpdXMpIHtcbiAgICAgIHBhcmVudE5vZGUuYWxpdmUgPSBmYWxzZVxuICAgICAgY29udGludWVcbiAgICB9XG5cbiAgICAvLyBDb25zdHJ1Y3QgYSBuZXcgbm9kZSBmcm9tIHRoZSBjdXJyZW50IG5vZGVcbiAgICBsZXQgbm9kZSA9IG5ld05vZGUoKVxuICAgIG5vZGUucGFyZW50ID0gcGFyZW50Tm9kZVxuICAgIG5vZGUudHJlZUlkID0gcGFyZW50Tm9kZS50cmVlSWRcbiAgICBub2RlLnIgPSBwYXJlbnROb2RlLnIgKyAwXG4gICAgbm9kZS50aGV0YSA9IHBhcmVudE5vZGUudGhldGFcbiAgICBub2RlLmJyYW5jaERlcHRoID0gcGFyZW50Tm9kZS5icmFuY2hEZXB0aFxuICAgIFxuICAgIC8vIElmIHBhcmVudCBub2RlIGFscmVhZHkgaGFzIGNoaWxkcmVuXG4gICAgaWYgKDAgPCBwYXJlbnROb2RlLmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgbm9kZS5icmFuY2hEZXB0aCsrXG4gICAgICBub2RlLnIgKj0gc2Vla1JhZGl1c0RlY2F5XG4gICAgfVxuXG4gICAgLy8gQWRkIHNvbWUgc3F1aWdnbGUgdG8gdGhlIGxpbmVzXG4gICAgbm9kZS50aGV0YSArPSAoXG4gICAgICAoMS4wIC0gMS4wLygobm9kZS5icmFuY2hEZXB0aCArIDEpKiowLjEpKSAqIHJhbmRvbUdhdXNzaWFuKCkgKiBhbmdsZU1heFxuICAgIClcblxuICAgIC8vIEF0ZW1wdCB0byBwbGFjZSBuZXcgbm9kZVxuICAgIGxldCBbdngsIHZ5XSA9IHZlY3Rvcihub2RlLnRoZXRhLCBwYXJlbnROb2RlLnIpXG4gICAgbm9kZS54ID0gcGFyZW50Tm9kZS54ICsgdnhcbiAgICBub2RlLnkgPSBwYXJlbnROb2RlLnkgKyB2eVxuXG4gICAgaWYoIWNhblBsYWNlTm9kZShub2RlLCBtYXNrLCB6b25lTWFwLCBicmFuY2hTcGFjaW5nKSlcbiAgICAgIGNvbnRpbnVlXG5cbiAgICBhbGxOb2Rlcy5wdXNoKG5vZGUpXG4gICAgem9uZU1hcC5hZGRJdGVtKG5vZGUueCwgbm9kZS55LCBub2RlKVxuICAgIHBhcmVudE5vZGUuY2hpbGRyZW4ucHVzaChub2RlKVxuXG4gICAgcmVuZGVyZXIubGluZShcbiAgICAgIHBhcmVudE5vZGUsXG4gICAgICBub2RlXG4gICAgKVxuICB9XG5cbiAgcmVuZGVyZXIuZG9uZSgpXG59XG5cbmZ1bmN0aW9uIHZlY3RvcihhbmdsZURlZywgbGVuZ3RoKSB7XG4gIGxldCByYWRpYW5zID0gYW5nbGVEZWcgKiBNYXRoLlBJIC8gMTgwXG4gIGxldCB2eCA9IE1hdGguY29zKHJhZGlhbnMpICogbGVuZ3RoXG4gIGxldCB2eSA9IE1hdGguc2luKHJhZGlhbnMpICogbGVuZ3RoXG4gIHJldHVybiBbdngsIHZ5XVxufVxuXG5mdW5jdGlvbiBidWlsZFJvb3RzKG51bVJvb3RzLCB3LCBoLCBtYXhTZWVrUmFkaXVzLCBtYXNrKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKG5ldyBBcnJheShudW1Sb290cykpXG4gICAgLm1hcCgoKSA9PiB7XG4gICAgICBsZXQgeCwgeVxuICAgICAgZG8ge1xuICAgICAgICB4ID0gcmFuZG9tSW50KHcpXG4gICAgICAgIHkgPSByYW5kb21JbnQoaClcbiAgICAgIH0gd2hpbGUoIW1hc2suY2FuUGxhY2VSb290KHgsIHkpKVxuICAgICAgcmV0dXJuIFt4LCB5XVxuICAgIH0pXG4gICAgLm1hcCgoW3gsIHldLCBpKSA9PiB7XG4gICAgICBsZXQgcm9vdCA9IG5ld05vZGUoeCwgeSlcbiAgICAgIHJvb3QuciA9IG1heFNlZWtSYWRpdXNcbiAgICAgIHJvb3QudGhldGEgPSByYW5kb21JbnQoMzYwKVxuICAgICAgcm9vdC50cmVlSWQgPSBpXG4gICAgICByZXR1cm4gcm9vdFxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIHJhbmRvbU1lbWJlcihsaXN0KSB7XG4gIHJldHVybiBsaXN0WyByYW5kb21JbnQobGlzdC5sZW5ndGggLSAxKSBdXG59XG5cbmZ1bmN0aW9uIGNhblBsYWNlTm9kZShub2RlLCBtYXNrLCB6b25lTWFwLCBicmFuY2hTcGFjaW5nKSB7XG4gIGxldCB3aXRoaW5NYXNrID0gbWFzay5jYW5QbGFjZU5vZGUobm9kZS54LCBub2RlLnkpXG5cbiAgaWYoIXdpdGhpbk1hc2spXG4gICAgcmV0dXJuIGZhbHNlXG5cbiAgLy8gQ2hlY2sgZm9yIGNvbGxpc2lvbnNcbiAgcmV0dXJuIHpvbmVNYXBcbiAgICAuZ2V0SXRlbXNJbkFkamFjZW50Wm9uZXMobm9kZS54LCBub2RlLnkpXG4gICAgLm1hcCAobiA9PiB7XG4gICAgICBsZXQgZGlzdGFuY2VCZXR3ZWVuTm9kZXMgPSBNYXRoLnNxcnQoIHNxdWFyZShub2RlLnggLSBuLngpICsgc3F1YXJlKG5vZGUueSAtIG4ueSkgKVxuICAgICAgbGV0IGlzQ2xlYXIgPSBuLnIgKyBub2RlLnIgPCBkaXN0YW5jZUJldHdlZW5Ob2RlcyAqIGJyYW5jaFNwYWNpbmdcbiAgICAgIHJldHVybiBpc0NsZWFyXG4gICAgfSlcbiAgICAuZXZlcnkoYyA9PiBjKSBcbn1cblxuZnVuY3Rpb24gc3F1YXJlKG4pIHsgcmV0dXJuIG4qbiB9XG5cbmZ1bmN0aW9uIG5ld05vZGUoeCwgeSkge1xuICByZXR1cm4ge1xuICAgIHgsICAgICAgICAgICAgICAgICAgLy8gWC1Db29yZGluYXRlXG4gICAgeSwgICAgICAgICAgICAgICAgICAvLyBZLUNvb3JkaW5hdGVcbiAgICByOiAxLCAgICAgICAgICAgICAgIC8vIFJhZGl1c1xuICAgIHRoZXRhOiAwLCAgICAgICAgICAgLy8gSGVhZGluZyBhbmdsZVxuICAgIGJyYW5jaERlcHRoOiAxLCAgICAgLy8gSG93IGRlZXAgd2UndmUgYnJhbmNoZWQgZnJvbSB0aGUgcm9vdFxuICAgIGJyYW5jaEF0dGVtcHRzOiAwLCAgLy8gTnVtYmVyIG9mIHRpbWVzIHRoaXMgbm9kZSBoYXMgYXR0ZW1wdGVkIHRvIGJlIGJyYW5jaGVkXG4gICAgcGFyZW50OiBudWxsLCAgICAgICAvLyBSZWZlcmVuY2UgdG8gcGFyZW50XG4gICAgY2hpbGRyZW46IFtdLCAgICAgICAvLyBSZWZlcmVuY2UgdG8gY2hpbGRyZW5cbiAgICB0cmVlSWQ6IDAsICAgICAgICAgIC8vIEEgc2VyaWFsIG51bWJlciB0byBpZGVudGlmeSB0cmVlcy4gU2hvdWxkIGJlIGluaGVyZXRlZCBmcm9tIHBhcmVudCB0byBjaGlsZFxuICAgIGFsaXZlOiB0cnVlXG4gIH1cbn1cbiIsImltcG9ydCB7IFJlbmRlckVtaXR0ZXIgfSBmcm9tICcuL3JlbmRlci9yZW5kZXJfZW1pdHRlci5qcydcbmltcG9ydCB7IE1hc2tEb251dCB9IGZyb20gJy4vbWFzay9tYXNrX2RvbnV0LmpzJ1xuaW1wb3J0IHsgZ3JvdyB9IGZyb20gJy4vZ3Jvd2VyLmpzJ1xuXG5cbm9ubWVzc2FnZSA9IChlKSA9PiB7XG4gIGNvbnNvbGUubG9nKGBbZ3Jvdy53b3JrZXJdIHJlY2VpdmVkIG1lc3NhZ2UgJHtlLmRhdGEuY21kfWApXG4gIHN3aXRjaCAoZS5kYXRhLmNtZCkge1xuICAgIGNhc2UgJ3J1bic6XG4gICAgICBydW4oZS5kYXRhLnBhcmFtcylcbiAgICAgIGJyZWFrXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUubG9nKGBbZ3Jvdy53b3JrZXJdIHVua25vd24gY29tbWFuZCAke2UuZGF0YS5jbWR9LCBkYXRhOiAke2UuZGF0YX1gKVxuICB9XG59XG5cbmZ1bmN0aW9uIHJ1bihwYXJhbXMpIHtcbiAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBwYXJhbXNcblxuICBsZXQgcmVuZGVyID0gbmV3IFJlbmRlckVtaXR0ZXIoKG1zZykgPT4gcG9zdE1lc3NhZ2UobXNnKSlcbiAgbGV0IG1hc2sgPSBuZXcgTWFza0RvbnV0KHdpZHRoLCBoZWlnaHQsIDEwMCwgMjgwKVxuXG4gIGdyb3cocGFyYW1zLCBtYXNrLCByZW5kZXIpXG59XG4iXSwic291cmNlUm9vdCI6IiJ9